/**
  ******************************************************************************
  * @file    main.c
  * @author  Ac6
  * @version V1.0
  * @date    01-December-2013
  * @brief   Default main function.
  ******************************************************************************
*/


#include "stm32f4xx.h"

#define SD_I2S_ALT_FUNC 5

#define SD_I2S_WS 4
#define SD_I2S_CK 5
#define SD_I2S_SD 6

int main(void)
{
	init();
	for(;;);
}

void init()
{
	// Enable RCC clock
	RCC_AHB1PeriphClockCmd(RCC_AHB1Periph_GPIOA | RCC_AHB1Periph_GPIOB, ENABLE);

	// Set I2S alternate function settings
	GPIO_InitTypeDef i2sPortSettings;
	GPIO_Struct_Init(&i2sPortSettings);
	i2sPortSettings.GPIO_Mode = GPIO_Mode_AF;
	GPIO_Init(GPIOA, &i2sPortSettings);
	// Now set up the alternate function.
	GPIO_PinAFConfig(GPIOA, SD_I2S_WS, SD_I2S_ALT_FUNC);
	GPIO_PinAFConfig(GPIOA, SD_I2S_CK, SD_I2S_ALT_FUNC);
	GPIO_PinAFConfig(GPIOA, SD_I2S_CK, SD_I2S_ALT_FUNC);

	// Set I2C alternate function settings
	GPIO_InitTypeDef i2cPortSettings;
	GPIO_Struct_Init(&i2cPortSettings);
	i2cPortSettings.GPIO_Mode = GPIO_Mode_AF;
	GPIO_Init(GPIOB, &i2cPortSettings);
}
